<mat-card class="form_cards currentSensorMain">
  <mat-toolbar
    class="mat-toolbar_all mat-toolbar details-toolbar mat-toolbar-single-row">
    <mat-card-title class="sidebar_form_title matCardTitles">
      {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.heading.datasource.currentSensor'): ""}}
      <small *ngIf="isActivePdSmall">{{datasourceTitleName}}</small>
    </mat-card-title>
  </mat-toolbar>
  <div class="mat-content">
    <mat-tab-group animationDuration="0ms" [selectedIndex]="tabIndex">
      <mat-tab label="Properties">
        <div [hidden]="!messageError">
          <mat-card class="validation-error">
          </mat-card>
        </div>
        <p>
          <mat-form-field class="w-50 marginTop" appearance="fill">
            <mat-label>
              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.name'): ""}}
            </mat-label>
            <input matInput name="name" type="text" [(ngModel)]="currentSensorDataSource.name">
          </mat-form-field>
          <mat-form-field class="w-50 marginTop" appearance="fill">
            <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.exportId'): ""}}</mat-label>
            <input matInput name="xid" [(ngModel)]="currentSensorDataSource.xid" type="text" disabled
                   placeholder="Autogenerated">
          </mat-form-field>
        </p>

        <p>
          <mat-form-field class="w-50 marginTop" appearance="fill">
            <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.permissions'): ""}}</mat-label>
            <mat-select name="editPermission" [(ngModel)]="editPermission" multiple disabled>
              <mat-option *ngFor="let read of readPermission" [value]="read">{{read}}</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="w-50 marginTop" appearance="fill">
            <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.bacnet.fields.placeholder.address'): ""}}</mat-label>
            <input disabled matInput name="address" type="text" required [(ngModel)]="currentSensorDataSource.address">
          </mat-form-field>
        </p>
        <mat-divider class="dividerAllCommonFields"></mat-divider>
        <p>
          <mat-slide-toggle name="anchorNode" [(ngModel)]="currentSensorDataSource.anchorNode"
                            (change)="onAnchorMode($event)"
                            class="side_form_toggle toggle_change allToggls form_field modbusInputField marginTop">
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataSource.field.anchorNode'): ""}}
          </mat-slide-toggle>

          <br>
          <mat-form-field class="w-50 marginTop" *ngIf="visibility" appearance="fill">
            <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataSource.field.location'): ""}}</mat-label>
            <input matInput [(ngModel)]="currentSensorDataSource.location" name="zone" type="text" required>
          </mat-form-field>
        </p>
        <br>
        <p>
          <button #updateButton matfab class="updateButton saveButton"
                  (click)="updateDatasource(currentSensorDataSource)">
            <mat-icon>save_as</mat-icon>
            {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.update') | uppercase) : ""}}
          </button>
        </p>
      </mat-tab>

      <mat-tab label="Points">
        <div class="sidebar-form" >
<!--          [hidden]="!dataPointHide"-->
          <div >
            <div  *ngFor="let error of currentSensorPointError" [hidden]="!messageError">
              <mat-card class="validation-error">
                <li>{{error.property}}
                  : {{error.message}}</li>
              </mat-card>
            </div>
            <p>
              <mat-form-field class="form_field w-50" appearance="fill">
                <mat-label>  {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.exportId'): ""}}</mat-label>
                <input readonly matInput [(ngModel)]="dataPointModel.xid"
                       name="xid" placeholder="xid" disabled>
              </mat-form-field>
              <mat-form-field class="form_field w-50" appearance="fill">
                <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.name'): ""}}</mat-label>
                <input matInput [(ngModel)]="dataPointModel.name"
                       name="name" type="text" required placeholder="Name">
              </mat-form-field>
            </p>
            <p>
              <mat-form-field *ngIf="attributeCode" class="form_field w-50 marginTop" appearance="fill">
                <mat-label> {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataPoint.attribute'): ""}}</mat-label>
                <mat-select readonly placeholder="Data Type" [(ngModel)]="currentSensorPointLocatorModel.attributeId"
                            name="attributeId" required disabled>
                  <mat-option *ngFor="let attr of attributeCode.codes" [value]="attr">
                    {{attr}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field *ngIf="attributeCode" class="form_field w-50 marginTop" appearance="fill">
                <mat-label> {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.currentSensor.fields.phase'): ""}}</mat-label>
                <mat-select readonly placeholder="Data Type" [(ngModel)]="currentSensorPointLocatorModel.phaseId"
                            name="phaseId" required disabled>
                  <mat-option *ngFor="let attr of attributeCodeCurrent.PHASE_CODES.codes" [value]="attr.code">
                    {{attr.name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </p>

            <p>
              <mat-form-field *ngIf="attributeCode" class="form_field w-50 marginTop" appearance="fill">
                <mat-label> {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.currentSensor.fields.ct'): ""}}</mat-label>
                <mat-select placeholder="Data Type" [(ngModel)]="currentSensorPointLocatorModel.ctId" name="ctId"
                            required>
                  <mat-option *ngFor="let attr of attributeCodeCurrent.CT_CODES.codes" [value]="attr.code">
                    {{attr.name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </p>
            <div>
              <button matfab class="Update_Button saveButton" (click)="updateDataPoint()">
                <mat-icon>save_as</mat-icon>
              {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.update') | uppercase) : ""}}
              </button>
            </div>
          </div>
        </div>
        <app-datapoint-table (editPoint)="editDataPoint($event)">
        </app-datapoint-table>
      </mat-tab>
    </mat-tab-group>
  </div>
</mat-card>
