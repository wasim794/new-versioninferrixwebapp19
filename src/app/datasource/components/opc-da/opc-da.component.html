<mat-card class="form_cards">
  <mat-toolbar
    class="mat-toolbar_all mat-toolbar details-toolbar mat-toolbar-single-row">
    <mat-card-title class="sidebar_form_title">
      {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.heading.datasource.opc-da'): ""}}
    </mat-card-title>
  </mat-toolbar>
  <div class="mat-content">
    <div  *ngFor="let error of peoleCountError" [hidden]="!messageError">
      <mat-card class="validation-error">
        <li>{{error.property}}
          : {{error.message}}</li>
      </mat-card>
    </div>
    <mat-tab-group animationDuration="0ms" [selectedIndex]="tabIndex">
      <mat-tab label="Properties">
      <form class="">
          <mat-form-field class="form_field  marginTop w-50" appearance="fill">
            <mat-label>
              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.name'): ""}}
            </mat-label>
            <input matInput name="name" type="text" [(ngModel)]="OpcDatasource.name">
          </mat-form-field>
          <mat-form-field class="form_field  marginTop w-50 marginLeft-20" appearance="fill">
            <mat-label> {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.exportId'): ""}}</mat-label>
            <input matInput [(ngModel)]="OpcDatasource.xid"
                   name="xid" type="text" class="datasourceBoxHeight" required readonly placeholder="Autogenerated">
          </mat-form-field>

          <mat-form-field class="form_field  marginTop w-50" appearance="fill">
            <mat-label disabled> {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.heading.permissions'): ""}}</mat-label>
            <mat-select name="editPermission" [(ngModel)]="editPermission" multiple>
              <mat-option *ngFor="let read of readPermission" [value]="read">{{read}}</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="form_field  marginTop w-50 marginLeft-20" appearance="fill">
            <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.bacnet.fields.placeholder.address'): ""}}</mat-label>
            <input matInput [(ngModel)]="OpcDatasource.address"
                   name="address" type="text">
          </mat-form-field>

        <mat-divider class="dividerAllCommonFields"></mat-divider>

          <mat-slide-toggle name="anchorNode" (change)="onAnchorMode($event)" [(ngModel)]="OpcDatasource.anchorNode"
                            class="side_form_toggle toggle_change allToggls form_field modbusInputField marginTop W-50">
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataSource.field.anchorNode'): ""}}
          </mat-slide-toggle>
          <mat-form-field *ngIf="visibility"
                          class="form_field w-50 marginTop locationInputBox" appearance="fill">
            <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataSource.field.location'): ""}}</mat-label>
            <input matInput [(ngModel)]="OpcDatasource.location"
                   name="location" type="text">
          </mat-form-field>

        <mat-divider class="dividerAllCommonFields"></mat-divider>

        <mat-form-field class="form_field w-50 marginTop " appearance="fill">
          <mat-label>
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.modbus.field.modbusIp.host'): ""}}
          </mat-label>
          <input matInput name="host" type="text" [(ngModel)]="OpcDatasource.host">
        </mat-form-field>
        <mat-form-field class="form_field w-50 marginTop marginLeft-20" appearance="fill">
          <mat-label>
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.opcda.placeholder.domain'): ""}}
          </mat-label>
          <input matInput name="domain" type="text" [(ngModel)]="OpcDatasource.domain">
        </mat-form-field>


        <mat-form-field class="form_field w-50 marginTop " appearance="fill">
          <mat-label>
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.recipients.fields.placeholder.user'): ""}}
          </mat-label>
          <input matInput name="user" type="text" [(ngModel)]="OpcDatasource.user">
        </mat-form-field>
        <mat-form-field class="form_field w-50 marginTop marginLeft-20" appearance="fill">
          <mat-label>
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.fields.password'): ""}}
          </mat-label>
          <input matInput name="password" type="password" [(ngModel)]="OpcDatasource.password">
        </mat-form-field>

        <mat-form-field class="form_field w-50 marginTop " appearance="fill">
          <mat-label>
            {{UIDICTIONARY ? UIDICTIONARY.get('ui.opcda.placeholder.server'): ""}}
          </mat-label>
          <mat-select name="editPermission" [(ngModel)]="OpcDatasource.server">
              <mat-option *ngFor="let read of serverListArray" [value]="read.key">{{read.val}}</mat-option>
            </mat-select>
        </mat-form-field>
          <button (click)="reloadServerList()"  mat-raised-button class="saveButton saveReloadServer marginLeft-20"  title="reload server list">
            <i class="material-icons dataSaverOn">data_saver_on</i></button>

        <br>
        <div *ngIf="!isEdit then save else update"></div>
        <ng-template #save>
          <button matfab class="saveButton" (click)="saveDatasource()">
             <mat-icon>save</mat-icon>
            {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.save') |  uppercase) : ""}}
          </button>
        </ng-template>
        <ng-template #update>
          <button matfab class="Update_Button saveButton" (click)="updateDatasource()">
             <mat-icon>save_as</mat-icon>
            {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.update') | uppercase) : ""}}
          </button>
        </ng-template>
       </form>
      </mat-tab>
      <mat-tab label="Points">
        <div class="sidebar-form dataPointTabs">
          <div >
<!--            [hidden]="!dataPointHide"-->

              <mat-form-field class="form_field allInputsMargin" appearance="fill">
                <mat-label> {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.exportId'): ""}}</mat-label>
                <input readonly matInput [(ngModel)]="dataPointModel.xid"
                       name="xid" placeholder="xid" class="datasourceBoxHeight">
              </mat-form-field>
              <mat-form-field class="form_field" appearance="fill">
                <mat-label>{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.name'): ""}}</mat-label>
                <input matInput [(ngModel)]="dataPointModel.name"
                       name="name" type="text" required placeholder="Name">
              </mat-form-field>

              <mat-form-field class="form_field modbusInputField marginTop" appearance="fill">
                <mat-label>
                  {{UIDICTIONARY ? UIDICTIONARY.get('ui.opcda.placeholder.tagList'): ""}}
                </mat-label>
                <mat-select name="editPermission" [(ngModel)]="OpcPointLocator.tag">
                  <mat-option *ngFor="let read of serverListArray" [value]="read.key">{{read.val}}</mat-option>
                </mat-select>
              </mat-form-field>

            <div class="">
              <div *ngIf="!datapointButtonsView then savePoint else updatePoint"></div>
              <ng-template #savePoint>
                <button matfab class="allDataPointSaveButton saveButton" (click)="saveDataPoint()">
                  <mat-icon>save</mat-icon>
                  {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.save') |  uppercase) : ""}}</button>
              </ng-template>
              <ng-template #updatePoint>
                <button matfab class="Update_Button saveButton" (click)="updateDataPoint()">
                  <mat-icon>save_as</mat-icon>
                  {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.update') | uppercase) : ""}}
                </button>
              </ng-template>
            </div>
            <button mat-raised-button (click)="cancelDataPoint()" class="cancel_button_new cancelPoint">{{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.cancel') | uppercase) : ""}}</button>
          </div>

        </div>
        <mat-divider class="dividerBorder"></mat-divider>
        <app-datapoint-table (editPoint)="editDataPoint($event)" (addPoint)="addNewDatapoint($event, 1)">
        </app-datapoint-table>
      </mat-tab>
    </mat-tab-group>
  </div>
</mat-card>

