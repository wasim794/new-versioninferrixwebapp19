<mat-card class="form_cards thermostatDataSourceMain">
  <mat-toolbar
    class="mat-toolbar_all mat-toolbar details-toolbar mat-toolbar-single-row"
  >
    <mat-card-title class="sidebar_form_title matCardTitles">
      {{UIDICTIONARY ? UIDICTIONARY.get('ui.meshConsole.menu.thermostat'): ""}}
      <small *ngIf="isActivePdSmall">{{datasourceTitleName}}</small>
    </mat-card-title>
  </mat-toolbar>
  <div class="mat-content">
    <div
      *ngFor="let error of thermostatDataSourcesError"
      [hidden]="!messageError"
    >
      <mat-card class="validation-error">
        <li>{{error.property}} : {{error.message}}</li>
      </mat-card>
    </div>
    <mat-tab-group animationDuration="0ms" [selectedIndex]="tabIndex">
      <mat-tab label="Properties">

          <mat-form-field class="w-50 modbusInputField" appearance="fill">
            <mat-label>
              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.name'): ""}}
            </mat-label>
            <input
              matInput
              name="name"
              [(ngModel)]="thermostatDatasource.name"
              type="text"
            />
          </mat-form-field>
          <mat-form-field
            class="w-50 modbusInputField marginTop"
            appearance="fill"
          >
            <mat-label>
              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.exportId'): ""}}</mat-label
            >
            <input
              matInput
              name="slaveId"
              [(ngModel)]="thermostatDatasource.xid"
              class="datasourceBoxHeight"
              type="text"
              required
              readonly
              disabled
              placeholder="Autogenerated"
            />
          </mat-form-field>

        <div>
<!--          <mat-form-field class="w-50 modbusInputField" appearance="fill">-->
<!--            <mat-label>-->
<!--              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.modbusControllerSlaveDevice.fields.pollingInterval'): ""}}-->
<!--            </mat-label>-->
<!--            <input-->
<!--              matInput-->
<!--              class="form-control"-->
<!--              name="timePeriod"-->
<!--              [(ngModel)]="thermostatDatasource.purgePeriod.timePeriod"-->
<!--              type="text"-->
<!--              required-->
<!--            />-->
<!--          </mat-form-field>-->
<!--          <mat-form-field class="w-50" appearance="fill">-->
<!--            <mat-label>-->
<!--              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.modbusControllerSlaveDevice.fields.pollingInterval'): ""}}-->
<!--              {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataPoint.textRender.type'): ""}}-->
<!--            </mat-label>-->
<!--            <mat-select-->
<!--              class="form-control"-->
<!--              name="timePeriodType"-->
<!--              [(ngModel)]="thermostatDatasource.purgePeriod.timePeriodType"-->
<!--            >-->
<!--              <mat-option-->
<!--                *ngFor="let timeperiod of timePeriods"-->
<!--                [value]="timeperiod.value"-->
<!--              >{{timeperiod.key}}-->
<!--              </mat-option>-->
<!--            </mat-select>-->
<!--          </mat-form-field>-->
        </div>

          <mat-form-field class="w-50 modbusInputField" appearance="fill">
            <mat-label
            >{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.bacnet.fields.placeholder.address'): ""}}</mat-label
            >
            <input
              matInput
              [(ngModel)]="thermostatDatasource.address"
              name="address"
              type="text"
              required
            />
          </mat-form-field>

          <mat-form-field class="w-50" appearance="fill">
            <mat-label
            >{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.heading.permissions'): ""}}</mat-label
            >
            <mat-select
              name="editPermission"
              [(ngModel)]="editPermission"
              multiple
            >
              <mat-option
                *ngFor="let read of readPermission"
                [value]="read"
              >{{read}}</mat-option
              >
            </mat-select>
          </mat-form-field>


          <button
            #updateButton
            mat-raised-button
            class="updateButton"
            (click)="updateDatasource()"
            *ngIf="datasourceIsEdit"
          >
            {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.update') | uppercase) : ""}}
          </button>
          <button
            #saveButton
            mat-raised-button
            class="saveButton"
            (click)="saveDatasource()"
            *ngIf="!datasourceIsEdit"
          >
            {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.save') |  uppercase) : ""}}
          </button>

      </mat-tab>

      <mat-tab label="Points">
        <div class="sidebar-form">
          <div [hidden]="!dataPointHide">

              <mat-form-field
                class="form_field allInputsMargin marginTop w-50"
                appearance="fill"
              >
                <mat-label>
                  {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.fields.name'): ""}}</mat-label
                >
                <input
                  matInput
                  name="name"
                  [(ngModel)]="dataPointModel.name"
                  type="text"
                  required
                />
              </mat-form-field>
              <mat-form-field class="form_field w-50" appearance="fill">
                <mat-label
                >{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.placeholder.exportId'): ""}}</mat-label
                >
                <input
                  matInput
                  name="xid"
                  class="datasourceBoxHeight"
                  [(ngModel)]="dataPointModel.xid"
                  type="text"
                  readonly
                  required
                />
              </mat-form-field>

            <div>
              <mat-form-field
                class="form_field allInputsMargin w-50"
                appearance="fill"
              >
                <mat-label
                >{{UIDICTIONARY ? UIDICTIONARY.get('ui.core.common.fields.dataType'): ""}}</mat-label
                >
                <mat-select
                  placeholder="Data Type"
                  [(ngModel)]="thermostatPointLocatorModel.dataType"
                  name="dataTypes"
                  required
                >
                  <mat-option *ngFor="let item of dataTypes" [value]="item.key">
                    {{item.value}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field class="datapoint_field w-50" appearance="fill">
                <mat-label>
                  {{UIDICTIONARY ? UIDICTIONARY.get('ui.core.dataPoint.attribute'): ""}}</mat-label
                >
                <mat-select placeholder="Attribute"
                            [(ngModel)]="thermostatPointLocatorModel.attributeId"
                            name="attributeId" required>
                  <mat-option *ngFor="let attr of attributeCode" [value]="attr">
                    {{attr}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div>
              <button
                mat-raised-button
                class="saveButton"
                (click)="updateDataPoint()"
              >
                {{UIDICTIONARY ? (UIDICTIONARY.get('ui.core.common.button.update') | uppercase) : ""}}
              </button>
            </div>
          </div>
        </div>
        <app-datapoint-table
          (editPoint)="editDataPoint($event)"
          (addPoint)="addNewDatapoint($event, 1)"
        >
        </app-datapoint-table>
      </mat-tab>
    </mat-tab-group>
  </div>
</mat-card>
